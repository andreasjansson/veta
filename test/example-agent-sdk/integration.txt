%skip(requires OPENAI_API_KEY) if: test -z "$OPENAI_API_KEY"

===
agent adds a note with unique content
===
cd "$CCTR_TEST_PATH/../../examples/agent-sdk" && TEST_PORT=8788 TEST_AGENT_ID=cctr-integration node test-ws-chat.mjs "Add a note with title 'Banana Smoothie Recipe' and body 'Blend 2 bananas with ice and milk' and tag 'recipes'. Use the addNote tool and confirm it was added."
---
{{ response }}
---
where
* response contains "Added note"

===
agent lists notes and shows the added content
===
cd "$CCTR_TEST_PATH/../../examples/agent-sdk" && TEST_PORT=8788 TEST_AGENT_ID=cctr-integration node test-ws-chat.mjs "List all notes. What notes exist?"
---
{{ response }}
---
where
* response contains "Banana" or response contains "banana"

===
agent shows the note with full content
===
cd "$CCTR_TEST_PATH/../../examples/agent-sdk" && TEST_PORT=8788 TEST_AGENT_ID=cctr-integration node test-ws-chat.mjs "Show me note 1. Display its full content."
---
{{ response }}
---
where
* response contains "Blend" or response contains "blend" or response contains "banana" or response contains "Banana"

===
agent searches and finds the note by content
===
cd "$CCTR_TEST_PATH/../../examples/agent-sdk" && TEST_PORT=8788 TEST_AGENT_ID=cctr-integration node test-ws-chat.mjs "Search the notes for the word 'Blend' using searchNotes. Return the matching note content."
---
{{ response }}
---
where
* response contains "Banana" or response contains "banana" or response contains "Smoothie" or response contains "smoothie" or response contains "Blend" or response contains "blend" or response contains "Recipe" or response contains "recipe"
